<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meridian Group | Slack</title>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Lato', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #fff;
      color: #1d1c1d;
      height: 100vh;
      overflow: hidden;
      font-size: 15px;
    }

    .slack-app {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }


    /* Main Layout */
    .slack-main {
      flex: 1;
      display: flex;
      overflow: hidden;
    }

    /* Top Bar */
    .top-bar {
      height: 44px;
      background: #350d36;
      display: flex;
      align-items: center;
      padding: 0 16px;
    }

    .top-bar-left {
      display: flex;
      align-items: center;
      gap: 8px;
      width: 220px;
    }

    .nav-btn {
      width: 28px;
      height: 28px;
      border-radius: 4px;
      border: none;
      background: transparent;
      color: rgba(255,255,255,0.7);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .nav-btn:hover {
      background: rgba(255,255,255,0.1);
    }

    .nav-btn.disabled {
      opacity: 0.4;
      cursor: default;
    }

    .nav-btn svg {
      width: 16px;
      height: 16px;
    }

    .top-bar-center {
      flex: 1;
      display: flex;
      justify-content: center;
    }

    .search-bar {
      width: 100%;
      max-width: 720px;
      height: 28px;
      background: rgba(255,255,255,0.2);
      border-radius: 6px;
      display: flex;
      align-items: center;
      padding: 0 10px;
      gap: 8px;
      cursor: text;
    }

    .search-bar svg {
      width: 15px;
      height: 15px;
      color: rgba(255,255,255,0.7);
    }

    .search-bar span {
      font-size: 13px;
      color: rgba(255,255,255,0.7);
    }

    .top-bar-right {
      width: 220px;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 8px;
    }

    .help-btn {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      border: 1px solid rgba(255,255,255,0.3);
      background: transparent;
      color: rgba(255,255,255,0.7);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 700;
    }

    .help-btn:hover {
      background: rgba(255,255,255,0.1);
    }

    /* Sidebar */
    .sidebar {
      width: 220px;
      background: #3f0e40;
      display: flex;
      flex-direction: column;
    }

    .workspace-switcher {
      padding: 8px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }

    .workspace-switcher:hover {
      background: rgba(255,255,255,0.1);
    }

    .workspace-icon {
      width: 26px;
      height: 26px;
      background: #fff;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 14px;
      color: #3f0e40;
    }

    .workspace-info {
      flex: 1;
    }

    .workspace-name {
      font-weight: 700;
      font-size: 15px;
      color: #fff;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .workspace-name svg {
      width: 12px;
      height: 12px;
    }

    .sidebar-nav {
      padding: 8px 0;
    }

    .nav-item {
      padding: 6px 16px;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      color: rgba(255,255,255,0.7);
      font-size: 15px;
    }

    .nav-item:hover {
      background: rgba(255,255,255,0.1);
    }

    .nav-item svg {
      width: 18px;
      height: 18px;
    }

    .nav-item .badge {
      margin-left: auto;
      background: #e01e5a;
      color: #fff;
      font-size: 11px;
      font-weight: 700;
      padding: 1px 6px;
      border-radius: 10px;
    }

    .sidebar-section {
      padding: 12px 0 4px;
    }

    .section-header {
      padding: 0 16px 4px;
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 15px;
      color: rgba(255,255,255,0.7);
      cursor: pointer;
    }

    .section-header:hover {
      color: #fff;
    }

    .section-header svg {
      width: 10px;
      height: 10px;
    }

    .channel-list {
      padding: 4px 0;
    }

    .channel-item {
      padding: 4px 16px 4px 24px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      color: rgba(255,255,255,0.7);
      font-size: 15px;
    }

    .channel-item:hover {
      background: rgba(255,255,255,0.1);
    }

    .channel-item.active {
      background: #1164a3;
      color: #fff;
    }

    .channel-item.unread {
      color: #fff;
      font-weight: 700;
    }

    .channel-item .hash {
      font-size: 15px;
      opacity: 0.7;
    }

    .dm-item {
      padding: 4px 16px 4px 24px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      color: rgba(255,255,255,0.7);
      font-size: 15px;
    }

    .dm-item:hover {
      background: rgba(255,255,255,0.1);
    }

    .dm-avatar {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: 700;
      position: relative;
    }

    .dm-avatar.online::after {
      content: '';
      position: absolute;
      bottom: -2px;
      right: -2px;
      width: 8px;
      height: 8px;
      background: #2bac76;
      border-radius: 50%;
      border: 2px solid #3f0e40;
    }

    .app-item {
      padding: 4px 16px 4px 24px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      color: rgba(255,255,255,0.7);
      font-size: 15px;
    }

    .app-item:hover {
      background: rgba(255,255,255,0.1);
    }

    .app-item.active {
      background: #1164a3;
      color: #fff;
    }

    .app-icon {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      overflow: hidden;
    }

    .app-icon img {
      width: 100%;
      height: 100%;
    }

    /* Content Area */
    .content-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #fff;
    }

    .channel-header {
      height: 49px;
      padding: 0 20px;
      display: flex;
      align-items: center;
      border-bottom: 1px solid #e1e1e1;
      background: #fff;
    }

    .channel-header-left {
      display: flex;
      align-items: center;
      gap: 4px;
      flex: 1;
    }

    .channel-title {
      font-weight: 900;
      font-size: 18px;
      color: #1d1c1d;
      display: flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
    }

    .channel-title:hover {
      background: #f8f8f8;
      border-radius: 4px;
      padding: 2px 4px;
      margin: -2px -4px;
    }

    .channel-title svg {
      width: 14px;
      height: 14px;
      color: #616061;
    }

    .channel-header-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .header-btn {
      height: 28px;
      padding: 0 12px;
      border-radius: 4px;
      border: none;
      background: transparent;
      color: #616061;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
    }

    .header-btn:hover {
      background: #f8f8f8;
    }

    .header-btn svg {
      width: 16px;
      height: 16px;
    }

    .members-btn {
      display: flex;
      align-items: center;
    }

    .member-avatars {
      display: flex;
    }

    .member-avatars .avatar {
      width: 24px;
      height: 24px;
      border-radius: 4px;
      margin-left: -6px;
      border: 2px solid #fff;
      font-size: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
    }

    .member-avatars .avatar:first-child {
      margin-left: 0;
    }

    .member-count {
      margin-left: 6px;
      font-size: 13px;
      color: #616061;
    }

    /* Messages */
    .messages-area {
      flex: 1;
      overflow-y: auto;
      padding: 16px 20px;
      background: #fff;
    }

    .date-divider {
      display: flex;
      align-items: center;
      margin: 16px 0;
    }

    .date-divider::before,
    .date-divider::after {
      content: '';
      flex: 1;
      height: 1px;
      background: #e1e1e1;
    }

    .date-divider span {
      padding: 0 16px;
      font-size: 13px;
      font-weight: 700;
      color: #616061;
      background: #fff;
      border: 1px solid #e1e1e1;
      border-radius: 24px;
      padding: 4px 12px;
    }

    .message {
      display: flex;
      gap: 8px;
      padding: 8px 0;
      position: relative;
    }

    .message:hover {
      background: #f8f8f8;
      margin: 0 -20px;
      padding: 8px 20px;
    }

    .message:hover .message-actions {
      display: flex;
    }

    .message-avatar {
      width: 36px;
      height: 36px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      font-weight: 700;
      font-size: 14px;
      overflow: hidden;
    }

    .message-avatar img {
      width: 100%;
      height: 100%;
    }

    .message-content {
      flex: 1;
      min-width: 0;
    }

    .message-header {
      display: flex;
      align-items: baseline;
      gap: 8px;
    }

    .message-author {
      font-weight: 900;
      font-size: 15px;
      color: #1d1c1d;
      cursor: pointer;
    }

    .message-author:hover {
      text-decoration: underline;
    }

    .app-badge {
      background: #e8e8e8;
      color: #616061;
      font-size: 10px;
      padding: 2px 4px;
      border-radius: 3px;
      font-weight: 700;
      text-transform: uppercase;
    }

    .message-time {
      font-size: 12px;
      color: #616061;
    }

    .message-text {
      font-size: 15px;
      line-height: 1.46;
      color: #1d1c1d;
      margin-top: 4px;
    }

    .message-text code {
      background: #f4f4f4;
      padding: 2px 4px;
      border-radius: 3px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 12px;
      color: #e01e5a;
    }

    .message-actions {
      display: none;
      position: absolute;
      top: -16px;
      right: 20px;
      background: #fff;
      border: 1px solid #e1e1e1;
      border-radius: 6px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .message-action-btn {
      width: 32px;
      height: 32px;
      border: none;
      background: transparent;
      color: #616061;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .message-action-btn:hover {
      background: #f8f8f8;
    }

    .message-action-btn svg {
      width: 16px;
      height: 16px;
    }

    /* Slack Blocks */
    .slack-block {
      margin-top: 8px;
      background: #f8f8f8;
      border-radius: 8px;
      border: 1px solid #e1e1e1;
      overflow: hidden;
      max-width: 600px;
    }

    .slack-block-header {
      padding: 12px 16px;
      border-bottom: 1px solid #e1e1e1;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .slack-block-header-icon {
      width: 20px;
      height: 20px;
      color: #0d9488;
    }

    .slack-block-header-text {
      font-weight: 700;
      font-size: 15px;
      color: #1d1c1d;
    }

    .slack-block-section {
      padding: 12px 16px;
    }

    .slack-block-fields {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px 16px;
    }

    .slack-field {
      font-size: 14px;
    }

    .slack-field-label {
      color: #616061;
      font-weight: 700;
      margin-bottom: 2px;
    }

    .slack-field-value {
      color: #1d1c1d;
    }

    .slack-block-divider {
      border-top: 1px solid #e1e1e1;
    }

    .slack-block-context {
      padding: 8px 16px;
      font-size: 12px;
      color: #616061;
      display: flex;
      align-items: center;
      gap: 6px;
      background: #f8f8f8;
    }

    .slack-block-actions {
      padding: 12px 16px;
      display: flex;
      gap: 8px;
      border-top: 1px solid #e1e1e1;
      background: #fff;
    }

    .slack-btn {
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      border: none;
      transition: all 0.15s;
    }

    .slack-btn-primary {
      background: #007a5a;
      color: #fff;
    }

    .slack-btn-primary:hover {
      background: #148567;
    }

    .slack-btn-danger {
      background: #e01e5a;
      color: #fff;
    }

    .slack-btn-danger:hover {
      background: #de4a73;
    }

    .slack-btn-secondary {
      background: #fff;
      color: #1d1c1d;
      border: 1px solid #e1e1e1;
    }

    .slack-btn-secondary:hover {
      background: #f8f8f8;
    }

    /* Status badges */
    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 700;
    }

    .status-high {
      background: #fce8e6;
      color: #d93025;
    }

    .status-medium {
      background: #fef7e0;
      color: #b06000;
    }

    .status-success {
      background: #e6f4ea;
      color: #137333;
    }

    .approval-status {
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 6px;
      border-top: 1px solid #e1e1e1;
    }

    .approval-status.approved {
      background: #e6f4ea;
      color: #137333;
    }

    .approval-status.rejected {
      background: #fce8e6;
      color: #d93025;
    }

    /* Message Input */
    .message-input-container {
      padding: 0 20px 20px;
      background: #fff;
    }

    .message-input-wrapper {
      background: #fff;
      border: 1px solid #868686;
      border-radius: 8px;
      overflow: hidden;
    }

    .message-input-wrapper:focus-within {
      border-color: #1264a3;
      box-shadow: 0 0 0 1px #1264a3;
    }

    .input-toolbar {
      display: flex;
      align-items: center;
      padding: 8px 12px;
      gap: 4px;
      border-bottom: 1px solid #e1e1e1;
    }

    .toolbar-btn {
      width: 28px;
      height: 28px;
      border-radius: 4px;
      border: none;
      background: transparent;
      color: #616061;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .toolbar-btn:hover {
      background: #f8f8f8;
    }

    .toolbar-btn svg {
      width: 16px;
      height: 16px;
    }

    .toolbar-divider {
      width: 1px;
      height: 20px;
      background: #e1e1e1;
      margin: 0 4px;
    }

    .message-input-field {
      padding: 12px;
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }

    .message-input {
      flex: 1;
      background: transparent;
      border: none;
      color: #1d1c1d;
      font-size: 15px;
      outline: none;
      resize: none;
      min-height: 22px;
      max-height: 200px;
      font-family: inherit;
    }

    .message-input::placeholder {
      color: #868686;
    }

    .input-actions {
      display: flex;
      align-items: center;
      padding: 8px 12px;
      justify-content: space-between;
    }

    .input-actions-left {
      display: flex;
      gap: 4px;
    }

    .input-actions-right {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .send-btn {
      width: 32px;
      height: 32px;
      border-radius: 4px;
      border: none;
      background: #007a5a;
      color: #fff;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .send-btn:hover {
      background: #148567;
    }

    .send-btn:disabled {
      background: #e8e8e8;
      color: #868686;
      cursor: default;
    }

    .send-btn svg {
      width: 16px;
      height: 16px;
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .message.new {
      animation: fadeIn 0.3s ease;
    }

    /* Typing indicator */
    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 0;
      font-size: 13px;
      color: #b9babc;
    }

    .typing-dots {
      display: flex;
      gap: 3px;
    }

    .typing-dots span {
      width: 6px;
      height: 6px;
      background: #b9babc;
      border-radius: 50%;
      animation: typing 1.4s infinite;
    }

    .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
    .typing-dots span:nth-child(3) { animation-delay: 0.4s; }

    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-4px); }
    }

    /* Reactions */
    .message-reactions {
      display: flex;
      gap: 4px;
      margin-top: 4px;
      flex-wrap: wrap;
    }

    .reaction {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      background: #f8f8f8;
      border: 1px solid #e1e1e1;
      border-radius: 12px;
      font-size: 12px;
      cursor: pointer;
    }

    .reaction:hover {
      background: #e8e8e8;
    }

    .reaction.active {
      background: #e8f5fa;
      border-color: #1264a3;
    }

    .reaction-emoji {
      font-size: 14px;
    }

    .reaction-count {
      color: #616061;
    }

    /* Thread preview */
    .thread-preview {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 8px;
      padding: 4px 8px;
      background: #f8f8f8;
      border-radius: 4px;
      cursor: pointer;
      font-size: 13px;
      color: #1264a3;
    }

    .thread-preview:hover {
      background: #e8e8e8;
    }

    .thread-avatars {
      display: flex;
    }

    .thread-avatars .avatar {
      width: 20px;
      height: 20px;
      border-radius: 4px;
      margin-left: -4px;
      border: 2px solid #f8f8f8;
      font-size: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
    }

    .thread-avatars .avatar:first-child {
      margin-left: 0;
    }
  </style>
</head>
<body>
  <div class="slack-app">
    <!-- Top Bar -->
    <div class="top-bar">
      <div class="top-bar-left">
        <button class="nav-btn disabled">
          <svg viewBox="0 0 20 20" fill="currentColor"><path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"/></svg>
        </button>
        <button class="nav-btn disabled">
          <svg viewBox="0 0 20 20" fill="currentColor"><path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/></svg>
        </button>
        <button class="nav-btn">
          <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/></svg>
        </button>
      </div>
      <div class="top-bar-center">
        <div class="search-bar">
          <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/></svg>
          <span>Search Meridian Group</span>
        </div>
      </div>
      <div class="top-bar-right">
        <button class="help-btn">?</button>
      </div>
    </div>

    <div class="slack-main">
      <!-- Sidebar -->
      <div class="sidebar">
        <div class="workspace-switcher">
          <div class="workspace-icon">M</div>
          <div class="workspace-info">
            <div class="workspace-name">
              Meridian Group
              <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>
            </div>
          </div>
        </div>

        <div class="sidebar-nav">
          <div class="nav-item">
            <svg viewBox="0 0 20 20" fill="currentColor"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/></svg>
            Home
          </div>
          <div class="nav-item">
            <svg viewBox="0 0 20 20" fill="currentColor"><path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"/><path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"/></svg>
            DMs
          </div>
          <div class="nav-item">
            <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"/></svg>
            Activity
            <span class="badge">3</span>
          </div>
          <div class="nav-item">
            <svg viewBox="0 0 20 20" fill="currentColor"><path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM14 11a1 1 0 011 1v1h1a1 1 0 110 2h-1v1a1 1 0 11-2 0v-1h-1a1 1 0 110-2h1v-1a1 1 0 011-1z"/></svg>
            More
          </div>
        </div>

        <div class="sidebar-section">
          <div class="section-header">
            <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>
            Channels
          </div>
          <div class="channel-list">
            <div class="channel-item"><span class="hash">#</span> general</div>
            <div class="channel-item active"><span class="hash">#</span> finance-ops</div>
            <div class="channel-item unread"><span class="hash">#</span> reconciliation-alerts</div>
            <div class="channel-item"><span class="hash">#</span> month-end-close</div>
          </div>
        </div>

        <div class="sidebar-section">
          <div class="section-header">
            <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>
            Apps
          </div>
          <div class="channel-list">
            <div class="app-item active">
              <div class="app-icon">
                <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
              </div>
              Clearledgr
            </div>
          </div>
        </div>

        <div class="sidebar-section">
          <div class="section-header">
            <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>
            Direct messages
          </div>
          <div class="channel-list">
            <div class="dm-item">
              <div class="dm-avatar online" style="background: #e01e5a; color: #fff;">MS</div>
              Maria Schmidt
            </div>
            <div class="dm-item">
              <div class="dm-avatar" style="background: #2bac76; color: #fff;">TM</div>
              Thomas Mueller
            </div>
            <div class="dm-item">
              <div class="dm-avatar online" style="background: #ecb22e; color: #fff;">AK</div>
              Anna Klein
            </div>
          </div>
        </div>
      </div>

      <!-- Content Area -->
      <div class="content-area">
        <div class="channel-header">
          <div class="channel-header-left">
            <div class="channel-title">
              <span style="opacity: 0.5; margin-right: 4px;">#</span> finance-ops
              <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>
            </div>
          </div>
          <div class="channel-header-right">
            <button class="header-btn members-btn">
              <div class="member-avatars">
                <div class="avatar" style="background: #e01e5a; color: #fff;">MS</div>
                <div class="avatar" style="background: #2bac76; color: #fff;">TM</div>
                <div class="avatar" style="background: #ecb22e; color: #fff;">AK</div>
              </div>
              <span class="member-count">12</span>
            </button>
            <button class="header-btn">
              <svg viewBox="0 0 20 20" fill="currentColor"><path d="M5 4a2 2 0 012-2h6a2 2 0 012 2v14l-5-2.5L5 18V4z"/></svg>
            </button>
            <button class="header-btn">
              <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/></svg>
            </button>
          </div>
        </div>

        <div class="messages-area" id="messagesArea">
          <div class="date-divider">
            <span>Today</span>
          </div>
          <!-- Messages will be rendered here -->
        </div>

        <div class="message-input-container">
          <div class="message-input-wrapper">
            <div class="input-toolbar">
              <button class="toolbar-btn">
                <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 100-2 1 1 0 000 2zm7-1a1 1 0 11-2 0 1 1 0 012 0zm-.464 5.535a1 1 0 10-1.415-1.414 3 3 0 01-4.242 0 1 1 0 00-1.415 1.414 5 5 0 007.072 0z" clip-rule="evenodd"/></svg>
              </button>
              <button class="toolbar-btn">
                <svg viewBox="0 0 20 20" fill="currentColor"><path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/><path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/></svg>
              </button>
              <button class="toolbar-btn">
                <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/></svg>
              </button>
              <div class="toolbar-divider"></div>
              <button class="toolbar-btn">
                <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.316 3.051a1 1 0 01.633 1.265l-4 12a1 1 0 11-1.898-.632l4-12a1 1 0 011.265-.633zM5.707 6.293a1 1 0 010 1.414L3.414 10l2.293 2.293a1 1 0 11-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0zm8.586 0a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 11-1.414-1.414L16.586 10l-2.293-2.293a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>
              </button>
              <button class="toolbar-btn">
                <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/></svg>
              </button>
              <button class="toolbar-btn">
                <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/></svg>
              </button>
              <button class="toolbar-btn">
                <svg viewBox="0 0 20 20" fill="currentColor"><path d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h6a1 1 0 010 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h6a1 1 0 110 2H4a1 1 0 01-1-1z"/></svg>
              </button>
            </div>
            <div class="message-input-field">
              <textarea class="message-input" id="messageInput" placeholder="Message #finance-ops" rows="1" onkeypress="handleKeyPress(event)"></textarea>
            </div>
            <div class="input-actions">
              <div class="input-actions-left">
                <button class="toolbar-btn">
                  <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM10 4a1 1 0 011 1v4h4a1 1 0 110 2h-4v4a1 1 0 11-2 0v-4H5a1 1 0 110-2h4V5a1 1 0 011-1z" clip-rule="evenodd"/></svg>
                </button>
                <button class="toolbar-btn">
                  <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M7 4a3 3 0 016 0v4a3 3 0 11-6 0V4zm4 10.93A7.001 7.001 0 0017 8a1 1 0 10-2 0A5 5 0 015 8a1 1 0 00-2 0 7.001 7.001 0 006 6.93V17H6a1 1 0 100 2h8a1 1 0 100-2h-3v-2.07z" clip-rule="evenodd"/></svg>
                </button>
              </div>
              <div class="input-actions-right">
                <button class="send-btn" id="sendBtn" disabled onclick="sendMessage()">
                  <svg viewBox="0 0 20 20" fill="currentColor"><path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"/></svg>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Icons
    const ICONS = {
      check: '<svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/></svg>',
      alert: '<svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/></svg>',
      doc: '<svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd"/></svg>',
      chart: '<svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"/></svg>',
      bank: '<svg viewBox="0 0 20 20" fill="currentColor" width="16" height="16"><path d="M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z"/><path fill-rule="evenodd" d="M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z" clip-rule="evenodd"/></svg>'
    };

    // Demo data aligned with Gmail and Sheets
    const DEMO_DATA = {
      stats: {
        matched: 2801,
        matchRate: 98.4,
        exceptions: 3,
        pendingDrafts: 4
      },
      exceptions: [
        { id: 'EXC-001', type: 'Unidentified Transfer', amount: 5234.00, vendor: 'Unknown', priority: 'HIGH' },
        { id: 'EXC-002', type: 'Amount Mismatch', amount: 156.80, vendor: 'Stripe', priority: 'MEDIUM' },
        { id: 'EXC-003', type: 'Missing Invoice', amount: 2100.00, vendor: 'Unknown', priority: 'MEDIUM' }
      ],
      drafts: [
        { id: 'DRF-001', description: 'SAP S/4HANA License - Q1 2026', amount: 45000.00, glCode: '6200', confidence: 98 },
        { id: 'DRF-002', description: 'Stripe Invoice - January 2026', amount: 12847.32, glCode: '6150', confidence: 97 },
        { id: 'DRF-003', description: 'AWS Infrastructure - January 2026', amount: 8234.50, glCode: '6200', confidence: 96 },
        { id: 'DRF-004', description: 'Office Rent - January 2026', amount: 12500.00, glCode: '6100', confidence: 94 }
      ]
    };

    function formatCurrency(amount) {
      return 'â‚¬' + amount.toLocaleString('de-DE', { minimumFractionDigits: 2 });
    }

    function getCurrentTime() {
      return new Date().toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });
    }

    function simulateDelay(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    // Render initial messages
    function renderInitialMessages() {
      const area = document.getElementById('messagesArea');
      
      // Reconciliation complete message
      area.innerHTML += `
        <div class="message new">
          <div class="message-avatar">
            <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
          </div>
          <div class="message-content">
            <div class="message-header">
              <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
              <span class="message-time">9:47 AM</span>
            </div>
            <div class="message-text">
              <strong>Reconciliation Complete</strong> â€” Deutsche Bank statement processed
            </div>
            <div class="slack-block">
              <div class="slack-block-header">
                <span class="slack-block-header-icon">${ICONS.chart}</span>
                <span class="slack-block-header-text">3-Way Reconciliation Complete</span>
              </div>
              <div class="slack-block-section">
                <div style="display: flex; align-items: center; justify-content: center; gap: 8px; padding: 8px 0 16px; font-size: 13px; color: #616061;">
                  <span style="background: #e6f4ea; color: #137333; padding: 4px 8px; border-radius: 4px; font-weight: 600;">Stripe</span>
                  <span>â†”</span>
                  <span style="background: #e8f5fa; color: #1264a3; padding: 4px 8px; border-radius: 4px; font-weight: 600;">Deutsche Bank</span>
                  <span>â†”</span>
                  <span style="background: #fef7e0; color: #b06000; padding: 4px 8px; border-radius: 4px; font-weight: 600;">SAP GL</span>
                </div>
                <div class="slack-block-fields">
                  <div class="slack-field">
                    <div class="slack-field-label">3-Way Matched</div>
                    <div class="slack-field-value" style="color: #137333;">2,801 transactions</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Match Rate</div>
                    <div class="slack-field-value" style="color: #137333;">98.4%</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Exceptions</div>
                    <div class="slack-field-value" style="color: #d93025;">3 items</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Total Reconciled</div>
                    <div class="slack-field-value">â‚¬312,847.23</div>
                  </div>
                </div>
              </div>
              <div class="slack-block-context">
                Data sources: Stripe API â€¢ Deutsche Bank ****4892 â€¢ SAP S/4HANA GL
              </div>
            </div>
            <div class="message-reactions">
              <div class="reaction active">
                <span class="reaction-emoji">OK</span>
                <span class="reaction-count">3</span>
              </div>
              <div class="reaction">
                <span class="reaction-emoji">Review</span>
                <span class="reaction-count">1</span>
              </div>
            </div>
          </div>
          <div class="message-actions">
            <button class="message-action-btn" title="Add reaction">React</button>
            <button class="message-action-btn" title="Reply in thread">
              <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd"/></svg>
            </button>
            <button class="message-action-btn" title="Share message">
              <svg viewBox="0 0 20 20" fill="currentColor"><path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z"/></svg>
            </button>
            <button class="message-action-btn" title="More actions">
              <svg viewBox="0 0 20 20" fill="currentColor"><path d="M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"/></svg>
            </button>
          </div>
        </div>
      `;

      // Exception alert
      area.innerHTML += `
        <div class="message new" id="exception-EXC-001">
          <div class="message-avatar">
            <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
          </div>
          <div class="message-content">
            <div class="message-header">
              <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
              <span class="message-time">9:48 AM</span>
            </div>
            <div class="message-text">
              <span class="status-badge status-high">${ICONS.alert} HIGH PRIORITY</span> Exception requires review
            </div>
            <div class="slack-block">
              <div class="slack-block-section">
                <div class="slack-block-fields">
                  <div class="slack-field">
                    <div class="slack-field-label">Type</div>
                    <div class="slack-field-value">Unidentified Transfer</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Amount</div>
                    <div class="slack-field-value">â‚¬5,234.00</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Reference</div>
                    <div class="slack-field-value"><code>TRF-UNKNOWN</code></div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Bank</div>
                    <div class="slack-field-value">Deutsche Bank</div>
                  </div>
                </div>
              </div>
              <div class="slack-block-context">
                ðŸ’¡ Vita AI: This appears to be a customer prepayment. Suggested GL: 2300 (Deferred Revenue)
              </div>
              <div class="slack-block-actions" id="exception-actions-EXC-001">
                <button class="slack-btn slack-btn-primary" onclick="resolveException('EXC-001')">Accept Suggestion</button>
                <button class="slack-btn slack-btn-secondary" onclick="showExceptionDetails('EXC-001')">View Details</button>
                <button class="slack-btn slack-btn-danger">Flag for Review</button>
              </div>
            </div>
          </div>
          <div class="message-actions">
            <button class="message-action-btn" title="Add reaction">React</button>
            <button class="message-action-btn" title="Reply in thread">
              <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd"/></svg>
            </button>
            <button class="message-action-btn" title="Share message">
              <svg viewBox="0 0 20 20" fill="currentColor"><path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z"/></svg>
            </button>
            <button class="message-action-btn" title="More actions">
              <svg viewBox="0 0 20 20" fill="currentColor"><path d="M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"/></svg>
            </button>
          </div>
        </div>
      `;

      // Draft approval message
      area.innerHTML += `
        <div class="message new" id="draft-DRF-001">
          <div class="message-avatar">
            <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
          </div>
          <div class="message-content">
            <div class="message-header">
              <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
              <span class="message-time">9:49 AM</span>
            </div>
            <div class="message-text">
              ${ICONS.doc} <strong>Draft Journal Entry</strong> ready for approval
            </div>
            <div class="slack-block">
              <div class="slack-block-section">
                <div class="slack-block-fields">
                  <div class="slack-field">
                    <div class="slack-field-label">Description</div>
                    <div class="slack-field-value">SAP S/4HANA License - Q1 2026</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Amount</div>
                    <div class="slack-field-value">â‚¬45,000.00</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">GL Code</div>
                    <div class="slack-field-value"><code>6200</code> Software & Licenses</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Confidence</div>
                    <div class="slack-field-value"><span class="status-badge status-success">98%</span></div>
                  </div>
                </div>
              </div>
              <div class="slack-block-context">
                Extracted from: SAP SE Invoice #SAP-LIC-89234
              </div>
              <div class="slack-block-actions" id="draft-actions-DRF-001">
                <button class="slack-btn slack-btn-primary" onclick="approveDraft('DRF-001')">Approve & Post</button>
                <button class="slack-btn slack-btn-danger" onclick="rejectDraft('DRF-001')">Reject</button>
                <button class="slack-btn slack-btn-secondary" onclick="editDraft('DRF-001')">Edit</button>
              </div>
            </div>
            <div class="thread-preview">
              <div class="thread-avatars">
                <div class="avatar" style="background: #e01e5a; color: #fff;">MS</div>
              </div>
              1 reply
            </div>
          </div>
          <div class="message-actions">
            <button class="message-action-btn" title="Add reaction">React</button>
            <button class="message-action-btn" title="Reply in thread">
              <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z" clip-rule="evenodd"/></svg>
            </button>
            <button class="message-action-btn" title="Share message">
              <svg viewBox="0 0 20 20" fill="currentColor"><path d="M15 8a3 3 0 10-2.977-2.63l-4.94 2.47a3 3 0 100 4.319l4.94 2.47a3 3 0 10.895-1.789l-4.94-2.47a3.027 3.027 0 000-.74l4.94-2.47C13.456 7.68 14.19 8 15 8z"/></svg>
            </button>
            <button class="message-action-btn" title="More actions">
              <svg viewBox="0 0 20 20" fill="currentColor"><path d="M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z"/></svg>
            </button>
          </div>
        </div>
      `;

      scrollToBottom();
    }

    async function resolveException(id) {
      const actionsDiv = document.getElementById(`exception-actions-${id}`);
      const messageDiv = document.getElementById(`exception-${id}`);
      
      actionsDiv.innerHTML = `
        <div class="approval-status approved">
          <span class="icon">${ICONS.check}</span>
          Resolved by @maria.schmidt â€¢ ${getCurrentTime()}
        </div>
      `;

      await simulateDelay(800);

      addMessage(`
        <div class="message-avatar">
          <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
        </div>
        <div class="message-content">
          <div class="message-header">
            <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
            <span class="message-time">${getCurrentTime()}</span>
          </div>
          <div class="message-text">
            Exception <code>${id}</code> resolved. Journal entry created and posted to SAP S/4HANA.
          </div>
        </div>
      `);
    }

    function showExceptionDetails(id) {
      const actionsDiv = document.getElementById(`exception-actions-${id}`);
      
      // Get exception data
      const exception = DEMO_DATA.exceptions.find(e => e.id === id) || DEMO_DATA.exceptions[0];
      
      actionsDiv.innerHTML = `
        <div style="padding: 12px 0; width: 100%;">
          <div style="font-size: 13px; font-weight: 700; color: #616061; margin-bottom: 12px;">Transaction Details</div>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px 16px; font-size: 14px;">
            <div><span style="color: #616061; font-weight: 600;">Date:</span> <span style="color: #1d1c1d;">Jan 8, 2026</span></div>
            <div><span style="color: #616061; font-weight: 600;">Bank Ref:</span> <span style="color: #1d1c1d;">TRF-UNKNOWN</span></div>
            <div><span style="color: #616061; font-weight: 600;">Description:</span> <span style="color: #1d1c1d;">TRANSFER - UNKNOWN</span></div>
            <div><span style="color: #616061; font-weight: 600;">Account:</span> <span style="color: #1d1c1d;">Deutsche Bank ****4892</span></div>
            <div><span style="color: #616061; font-weight: 600;">Amount:</span> <span style="color: #1d1c1d; font-weight: 700;">â‚¬${exception.amount.toLocaleString('de-DE', {minimumFractionDigits: 2})}</span></div>
            <div><span style="color: #616061; font-weight: 600;">Type:</span> <span style="color: #1d1c1d;">${exception.type}</span></div>
          </div>
          <div style="margin-top: 16px; padding: 12px; background: #e6f4ea; border-radius: 6px; font-size: 13px; color: #137333;">
            <strong>ðŸ’¡ Vita AI Suggestion:</strong> This appears to be a customer prepayment. Recommended GL: 2300 (Deferred Revenue)
          </div>
          <div style="margin-top: 16px; display: flex; gap: 8px;">
            <button class="slack-btn slack-btn-primary" onclick="resolveException('${id}')">Accept as Prepayment</button>
            <button class="slack-btn slack-btn-secondary" onclick="requestMoreInfo('${id}')">Request More Info</button>
            <button class="slack-btn slack-btn-danger" onclick="escalateException('${id}')">Escalate</button>
          </div>
        </div>
      `;
    }

    async function approveDraft(id) {
      const actionsDiv = document.getElementById(`draft-actions-${id}`);
      const messageDiv = document.getElementById(`draft-${id}`);
      
      actionsDiv.innerHTML = `
        <div class="approval-status approved">
          <span class="icon">${ICONS.check}</span>
          Approved by @thomas.mueller â€¢ ${getCurrentTime()}
        </div>
      `;

      await simulateDelay(800);

      addMessage(`
        <div class="message-avatar">
          <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
        </div>
        <div class="message-content">
          <div class="message-header">
            <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
            <span class="message-time">${getCurrentTime()}</span>
          </div>
          <div class="message-text">
            Draft <code>${id}</code> approved and posted to SAP S/4HANA. Document number: <code>1900045678</code>
          </div>
        </div>
      `);
    }

    async function rejectDraft(id) {
      const actionsDiv = document.getElementById(`draft-actions-${id}`);
      
      actionsDiv.innerHTML = `
        <div class="approval-status rejected">
          <span class="icon">${ICONS.alert}</span>
          Rejected by @thomas.mueller â€¢ ${getCurrentTime()}
        </div>
      `;

      await simulateDelay(500);

      addMessage(`
        <div class="message-avatar">
          <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
        </div>
        <div class="message-content">
          <div class="message-header">
            <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
            <span class="message-time">${getCurrentTime()}</span>
          </div>
          <div class="message-text">
             Draft <code>${id}</code> rejected. The entry has been moved back to pending review.
          </div>
        </div>
      `);
    }

    async function editDraft(id) {
      const draft = DEMO_DATA.drafts.find(d => d.id === id) || DEMO_DATA.drafts[0];
      const actionsDiv = document.getElementById(`draft-actions-${id}`);
      
      actionsDiv.innerHTML = `
        <div style="padding: 12px 0; width: 100%;">
          <div style="font-size: 13px; font-weight: 700; color: #616061; margin-bottom: 12px;">Edit Journal Entry</div>
          <div style="display: grid; gap: 12px; font-size: 14px;">
            <div>
              <label style="color: #616061; font-weight: 600; display: block; margin-bottom: 4px;">Description</label>
              <input type="text" value="${draft.description}" style="width: 100%; padding: 8px; border: 1px solid #e1e1e1; border-radius: 4px; font-size: 14px;">
            </div>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
              <div>
                <label style="color: #616061; font-weight: 600; display: block; margin-bottom: 4px;">Amount (â‚¬)</label>
                <input type="text" value="${draft.amount.toLocaleString('de-DE', {minimumFractionDigits: 2})}" style="width: 100%; padding: 8px; border: 1px solid #e1e1e1; border-radius: 4px; font-size: 14px;">
              </div>
              <div>
                <label style="color: #616061; font-weight: 600; display: block; margin-bottom: 4px;">GL Code</label>
                <select style="width: 100%; padding: 8px; border: 1px solid #e1e1e1; border-radius: 4px; font-size: 14px;">
                  <option ${draft.glCode === '6200' ? 'selected' : ''}>6200 - Software & Licenses</option>
                  <option ${draft.glCode === '6150' ? 'selected' : ''}>6150 - Payment Processing</option>
                  <option ${draft.glCode === '6100' ? 'selected' : ''}>6100 - Rent & Facilities</option>
                  <option>6300 - Professional Services</option>
                  <option>6400 - Marketing</option>
                </select>
              </div>
            </div>
          </div>
          <div style="margin-top: 16px; display: flex; gap: 8px;">
            <button class="slack-btn slack-btn-primary" onclick="saveEditDraft('${id}')">Save Changes</button>
            <button class="slack-btn slack-btn-secondary" onclick="cancelEditDraft('${id}')">Cancel</button>
          </div>
        </div>
      `;
    }

    async function saveEditDraft(id) {
      const actionsDiv = document.getElementById(`draft-actions-${id}`);
      
      actionsDiv.innerHTML = `
        <div class="approval-status approved">
          <span class="icon">${ICONS.check}</span>
          Updated by @thomas.mueller â€¢ ${getCurrentTime()}
        </div>
      `;

      await simulateDelay(500);

      addMessage(`
        <div class="message-avatar">
          <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
        </div>
        <div class="message-content">
          <div class="message-header">
            <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
            <span class="message-time">${getCurrentTime()}</span>
          </div>
          <div class="message-text">
            âœï¸ Draft <code>${id}</code> updated successfully. Ready for approval.
          </div>
        </div>
      `);
    }

    function cancelEditDraft(id) {
      const draft = DEMO_DATA.drafts.find(d => d.id === id) || DEMO_DATA.drafts[0];
      const actionsDiv = document.getElementById(`draft-actions-${id}`);
      
      actionsDiv.innerHTML = `
        <button class="slack-btn slack-btn-primary" onclick="approveDraft('${id}')">Approve & Post</button>
        <button class="slack-btn slack-btn-danger" onclick="rejectDraft('${id}')">Reject</button>
        <button class="slack-btn slack-btn-secondary" onclick="editDraft('${id}')">Edit</button>
      `;
    }

    async function escalateException(id) {
      const actionsDiv = document.getElementById(`exception-actions-${id}`);
      
      actionsDiv.innerHTML = `
        <div class="approval-status" style="background: #fef7e0; color: #b06000;">
          <span class="icon">${ICONS.alert}</span>
          Escalated to @maria.schmidt â€¢ ${getCurrentTime()}
        </div>
      `;

      await simulateDelay(500);

      addMessage(`
        <div class="message-avatar">
          <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
        </div>
        <div class="message-content">
          <div class="message-header">
            <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
            <span class="message-time">${getCurrentTime()}</span>
          </div>
          <div class="message-text">
            Exception <code>${id}</code> escalated to <strong>@maria.schmidt</strong> (Finance Manager) for review.
          </div>
        </div>
      `);

      // Simulate Maria responding
      await simulateDelay(2000);

      addMessage(`
        <div class="message-avatar" style="background: #e01e5a; color: #fff;">MS</div>
        <div class="message-content">
          <div class="message-header">
            <span class="message-author">Maria Schmidt</span>
            <span class="message-time">${getCurrentTime()}</span>
          </div>
          <div class="message-text">
            Thanks for flagging. I'll review this transfer and get back to you within the hour.
          </div>
        </div>
      `);
    }

    async function requestMoreInfo(id) {
      const actionsDiv = document.getElementById(`exception-actions-${id}`);
      
      actionsDiv.innerHTML = `
        <div style="padding: 12px 0; width: 100%;">
          <div style="font-size: 13px; font-weight: 700; color: #616061; margin-bottom: 12px;">Request Information</div>
          <div style="margin-bottom: 12px;">
            <label style="color: #616061; font-weight: 600; display: block; margin-bottom: 4px;">Send request to:</label>
            <select style="width: 100%; padding: 8px; border: 1px solid #e1e1e1; border-radius: 4px; font-size: 14px;">
              <option>@maria.schmidt (Finance Manager)</option>
              <option>@anna.klein (Accounts Payable)</option>
              <option>@thomas.mueller (Controller)</option>
              <option>External: vendor@company.com</option>
            </select>
          </div>
          <div style="margin-bottom: 12px;">
            <label style="color: #616061; font-weight: 600; display: block; margin-bottom: 4px;">Message:</label>
            <textarea style="width: 100%; padding: 8px; border: 1px solid #e1e1e1; border-radius: 4px; font-size: 14px; min-height: 60px; resize: vertical;">Can you please provide more details about this transfer of â‚¬5,234.00? We need to identify the source and purpose for proper categorization.</textarea>
          </div>
          <div style="display: flex; gap: 8px;">
            <button class="slack-btn slack-btn-primary" onclick="sendInfoRequest('${id}')">Send Request</button>
            <button class="slack-btn slack-btn-secondary" onclick="cancelInfoRequest('${id}')">Cancel</button>
          </div>
        </div>
      `;
    }

    async function sendInfoRequest(id) {
      const actionsDiv = document.getElementById(`exception-actions-${id}`);
      
      actionsDiv.innerHTML = `
        <div class="approval-status" style="background: #e8f5fa; color: #1264a3;">
          <span class="icon">${ICONS.doc}</span>
          Info requested from @maria.schmidt â€¢ ${getCurrentTime()}
        </div>
      `;

      await simulateDelay(500);

      addMessage(`
        <div class="message-avatar">
          <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
        </div>
        <div class="message-content">
          <div class="message-header">
            <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
            <span class="message-time">${getCurrentTime()}</span>
          </div>
          <div class="message-text">
            ðŸ“§ Information request sent to <strong>@maria.schmidt</strong> regarding exception <code>${id}</code>. You'll be notified when they respond.
          </div>
        </div>
      `);
    }

    function cancelInfoRequest(id) {
      showExceptionDetails(id);
    }

    function addMessage(content) {
      const area = document.getElementById('messagesArea');
      const msg = document.createElement('div');
      msg.className = 'message new';
      msg.innerHTML = content;
      area.appendChild(msg);
      scrollToBottom();
    }

    function scrollToBottom() {
      const area = document.getElementById('messagesArea');
      area.scrollTop = area.scrollHeight;
    }

    // Input handling
    const input = document.getElementById('messageInput');
    const sendBtn = document.getElementById('sendBtn');

    input.addEventListener('input', () => {
      sendBtn.disabled = !input.value.trim();
      input.style.height = 'auto';
      input.style.height = Math.min(input.scrollHeight, 200) + 'px';
    });

    function handleKeyPress(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    }

    async function sendMessage() {
      const text = input.value.trim();
      if (!text) return;

      // Add user message
      addMessage(`
        <div class="message-avatar" style="background: #2bac76; color: #fff;">TM</div>
        <div class="message-content">
          <div class="message-header">
            <span class="message-author">Thomas Mueller</span>
            <span class="message-time">${getCurrentTime()}</span>
          </div>
          <div class="message-text">${text}</div>
        </div>
      `);

      input.value = '';
      input.style.height = 'auto';
      sendBtn.disabled = true;

      // Process commands
      const lower = text.toLowerCase();
      
      if (lower.startsWith('/clearledgr')) {
        await handleCommand(lower);
      } else if (lower.includes('@clearledgr') || lower.includes('cash') || lower.includes('balance') || lower.includes('exception') || lower.includes('draft')) {
        await handleQuestion(lower);
      }
    }

    async function handleCommand(cmd) {
      await simulateDelay(500);

      if (cmd.includes('help')) {
        addMessage(`
          <div class="message-avatar">
            <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
          </div>
          <div class="message-content">
            <div class="message-header">
              <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
              <span class="message-time">${getCurrentTime()}</span>
            </div>
            <div class="message-text">
              <strong>Clearledgr Commands</strong><br><br>
              <code>/clearledgr status</code> â€” View reconciliation status<br>
              <code>/clearledgr exceptions</code> â€” View open exceptions<br>
              <code>/clearledgr drafts</code> â€” View pending draft entries<br>
              <code>/clearledgr approve [id]</code> â€” Approve a draft entry<br><br>
              You can also mention <code>@Clearledgr</code> to ask questions directly.
            </div>
          </div>
        `);
      } else if (cmd.includes('status')) {
        addMessage(`
          <div class="message-avatar">
            <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
          </div>
          <div class="message-content">
            <div class="message-header">
              <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
              <span class="message-time">${getCurrentTime()}</span>
            </div>
            <div class="slack-block">
              <div class="slack-block-header">
                <span class="slack-block-header-icon">${ICONS.chart}</span>
                <span class="slack-block-header-text">Current Status</span>
              </div>
              <div class="slack-block-section">
                <div class="slack-block-fields">
                  <div class="slack-field">
                    <div class="slack-field-label">Match Rate</div>
                    <div class="slack-field-value" style="color: #2bac76;">98.4%</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Matched</div>
                    <div class="slack-field-value">2,801 transactions</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Exceptions</div>
                    <div class="slack-field-value" style="color: #e01e5a;">3 open</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Pending Drafts</div>
                    <div class="slack-field-value">4 entries</div>
                  </div>
                </div>
              </div>
              <div class="slack-block-context">
                3-way match: Stripe â†” Deutsche Bank â†” SAP GL
              </div>
            </div>
          </div>
        `);
      } else if (cmd.includes('drafts')) {
        let draftsHtml = DEMO_DATA.drafts.map(d => 
          `â€¢ <code>${d.id}</code> ${d.description} â€” â‚¬${d.amount.toLocaleString('de-DE', {minimumFractionDigits: 2})} (${d.confidence}%)`
        ).join('<br>');
        
        addMessage(`
          <div class="message-avatar">
            <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
          </div>
          <div class="message-content">
            <div class="message-header">
              <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
              <span class="message-time">${getCurrentTime()}</span>
            </div>
            <div class="message-text">
              <strong>Pending Draft Entries (4)</strong><br><br>
              ${draftsHtml}<br><br>
              Use <code>/clearledgr approve [id]</code> to approve.
            </div>
          </div>
        `);
      }
    }

    async function handleQuestion(q) {
      await simulateDelay(800);

      if (q.includes('cash') || q.includes('balance')) {
        addMessage(`
          <div class="message-avatar">
            <img src="../gmail-extension/icons/icon48.png" alt="Clearledgr">
          </div>
          <div class="message-content">
            <div class="message-header">
              <span class="message-author">Clearledgr <span class="app-badge">APP</span></span>
              <span class="message-time">${getCurrentTime()}</span>
            </div>
            <div class="slack-block">
              <div class="slack-block-header">
                <span class="slack-block-header-icon">${ICONS.bank}</span>
                <span class="slack-block-header-text">Deutsche Bank ****4892</span>
              </div>
              <div class="slack-block-section">
                <div class="slack-block-fields">
                  <div class="slack-field">
                    <div class="slack-field-label">Current Balance</div>
                    <div class="slack-field-value" style="font-size: 20px; font-weight: 700;">â‚¬312,847.23</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">As of</div>
                    <div class="slack-field-value">Jan 22, 2026 9:47 AM</div>
                  </div>
                </div>
              </div>
              <div class="slack-block-divider"></div>
              <div class="slack-block-section">
                <div class="slack-block-fields">
                  <div class="slack-field">
                    <div class="slack-field-label">Inflows (MTD)</div>
                    <div class="slack-field-value" style="color: #2bac76;">+â‚¬75,888.07</div>
                  </div>
                  <div class="slack-field">
                    <div class="slack-field-label">Outflows (MTD)</div>
                    <div class="slack-field-value" style="color: #e01e5a;">-â‚¬53,234.50</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `);
      }
    }

    // Initialize
    renderInitialMessages();
  </script>
</body>
</html>
